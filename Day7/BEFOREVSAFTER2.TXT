
ğŸ§ª Example: 3 Nested Levels
beforeAll(() => console.log('G - beforeAll'));
afterAll(() => console.log('G - afterAll'));
beforeEach(() => console.log('G - beforeEach'));
afterEach(() => console.log('G - afterEach'));

describe('Level 1', () => {
  beforeAll(() => console.log('L1 - beforeAll'));
  afterAll(() => console.log('L1 - afterAll'));
  beforeEach(() => console.log('L1 - beforeEach'));
  afterEach(() => console.log('L1 - afterEach'));

  describe('Level 2', () => {
    beforeAll(() => console.log('L2 - beforeAll'));
    afterAll(() => console.log('L2 - afterAll'));
    beforeEach(() => console.log('L2 - beforeEach'));
    afterEach(() => console.log('L2 - afterEach'));

    test('deep test', () => console.log('TEST'));
  });
});

âœ… Exact Execution Order
G - beforeAll
L1 - beforeAll
L2 - beforeAll

G - beforeEach
L1 - beforeEach
L2 - beforeEach
TEST
L2 - afterEach
L1 - afterEach
G - afterEach

L2 - afterAll
L1 - afterAll
G - afterAll

ğŸ” Why This Happens (Rule-Based Explanation)
ğŸ”¹ beforeAll

Runs once per scope, outer â†’ inner

Global â†’ Level 1 â†’ Level 2

ğŸ”¹ beforeEach

Runs for every test, outer â†’ inner

Global â†’ Level 1 â†’ Level 2

ğŸ”¹ afterEach

Runs for every test, inner â†’ outer

Level 2 â†’ Level 1 â†’ Global

ğŸ”¹ afterAll

Runs once per scope, inner â†’ outer

Level 2 â†’ Level 1 â†’ Global

ğŸ§  The Golden Rule (Memorize This)
SETUP goes DOWN the tree
CLEANUP goes UP the tree


or

before*  â†’ outer â†’ inner
after*   â†’ inner â†’ outer

ğŸ§ª Stack Visualization (Mental Model)

Think of each describe as pushing onto a stack:

Setup Phase
push G
push L1
push L2

Cleanup Phase
pop L2
pop L1
pop G

ğŸ¯ Interview Trick Question (Quick Check)

â“ If Level 2 throws an error inside the test, will:

afterEach still run? âœ… YES

Parent afterEach run? âœ… YES

afterAll run? âœ… YES (if Jest doesnâ€™t crash)